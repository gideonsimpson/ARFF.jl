<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Structures · ARFF.jl</title><meta name="title" content="Structures · ARFF.jl"/><meta property="og:title" content="Structures · ARFF.jl"/><meta property="twitter:title" content="Structures · ARFF.jl"/><meta name="description" content="Documentation for ARFF.jl."/><meta property="og:description" content="Documentation for ARFF.jl."/><meta property="twitter:description" content="Documentation for ARFF.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ARFF.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Structures</a><ul class="internal"><li><a class="tocitem" href="#Data-Sets"><span>Data Sets</span></a></li><li><a class="tocitem" href="#Fourier-Feature-Models"><span>Fourier Feature Models</span></a></li><li><a class="tocitem" href="#Training-Options"><span>Training Options</span></a></li></ul></li><li><a class="tocitem" href="../train/">Training</a></li><li><a class="tocitem" href="../aux/">Auxiliary Functions and Utilities</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/example1/">Scalar Example</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Structures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Structures</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gideonsimpson/ARFF.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gideonsimpson/ARFF.jl/blob/main/docs/src/structs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-Structures"><a class="docs-heading-anchor" href="#Data-Structures">Data Structures</a><a id="Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structures" title="Permalink"></a></h1><ul><li><a href="#Data-Structures">Data Structures</a></li><li class="no-marker"><ul><li><a href="#Data-Sets">Data Sets</a></li><li><a href="#Fourier-Feature-Models">Fourier Feature Models</a></li><li><a href="#Training-Options">Training Options</a></li></ul></li></ul><h2 id="Data-Sets"><a class="docs-heading-anchor" href="#Data-Sets">Data Sets</a><a id="Data-Sets-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Sets" title="Permalink"></a></h2><p>Training (and testing data) are stored in <code>DataSet</code> structure.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.DataSet" href="#ARFF.DataSet"><code>ARFF.DataSet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DataSet{TB&lt;:Complex,TW&lt;:AbstractArray{AbstractFloat}}</code></pre><p>Training data containing (x,y) data pairs stored in arrays of x values and arrays of y values.</p><p><strong>Fields</strong></p><ul><li><code>x</code> - Array of real valued vectors </li><li><code>y</code> - Array of complex scalars</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/structs.jl#L45-L53">source</a></section></article><p>A training set can be constructed as follows</p><pre><code class="language-julia hljs">using ARFF
using Random
Random.seed!(100); # for reproducibility

n = 10; # number of sample points
x = [rand(2) for _ in 1:n];
f(x) = exp(-x[1]*x[2]); # arbitrary function
y = f.(x);

data = DataSet(x,y);
println(data.x)
println(data.y)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[[0.12364754150469992, 0.17728426618671156], [0.5844262152209776, 0.9102808037366388], [0.04170637082547557, 0.2882051781587147], [0.8650936306221244, 0.8445261118175335], [0.5088587881265387, 0.021567602762348703], [0.7211452674280416, 0.5056618567185127], [0.31371781140887434, 0.34261122353631823], [0.2325290249107962, 0.5860467972325104], [0.8793427937731793, 0.17708124683920934], [0.6808445302529258, 0.3737483795813732]]
ComplexF64[0.9783177502966277 + 0.0im, 0.587433656224266 + 0.0im, 0.9880519594959999 + 0.0im, 0.48162274398150406 + 0.0im, 0.98908513990478 + 0.0im, 0.6944357352604994 + 0.0im, 0.8980915714548457 + 0.0im, 0.8726044746868709 + 0.0im, 0.8558029582309944 + 0.0im, 0.7753315459150839 + 0.0im]</code></pre><p>Additionally, it is often helpful to scale the training data (setting means to zero and variances to unity).  These can be accomplished with the <code>DataScalings</code> structure and the associated functions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.DataScalings" href="#ARFF.DataScalings"><code>ARFF.DataScalings</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DataScalings{TB&lt;:Complex,TR&lt;:AbstractFloat,TW&lt;:AbstractArray{TR}}</code></pre><p>Data structure holding the scalings of a <code>DataSet</code> type.  Used for centering and scaling the data to improve training.</p><p><strong>Fields</strong></p><ul><li><code>μx</code> - Mean in <code>x</code></li><li><code>σ2x</code> - Variance in <code>x</code></li><li><code>μy</code> - Mean in <code>y</code></li><li><code>σ2y</code> - Variance in <code>y</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/structs.jl#L101-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.get_scalings" href="#ARFF.get_scalings"><code>ARFF.get_scalings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_scalings(data::DataSet{TB,TR,TW}) where {TB&lt;:Complex,TR&lt;:AbstractFloat,TW&lt;:AbstractArray{TR}}</code></pre><p>Find the means and variances of the data for scaling</p><p><strong>Fields</strong></p><ul><li><code>data</code> - The training data set</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/utils.jl#L49-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.scale_data!" href="#ARFF.scale_data!"><code>ARFF.scale_data!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">scale_data!(data::DataSet{TB,TR,TW}, scalings::DataScalings{TB,TR,TW}) where {TB&lt;:Complex,TR&lt;:AbstractFloat,TW&lt;:AbstractArray{TR}}</code></pre><p>Scale the data set (in-place) according to the specified scalings</p><p><strong>Fields</strong></p><ul><li><code>data</code> - Data set to be scale</li><li><code>scalings</code> - Scalings to apply to <code>data</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/utils.jl#L65-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.rescale_data!" href="#ARFF.rescale_data!"><code>ARFF.rescale_data!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rescale_data!(data::DataSet{TB,TR,TW}, scalings::DataScalings{TB,TR,TW}) where {TB&lt;:Complex,TR&lt;:AbstractFloat,TW&lt;:AbstractArray{TR}}</code></pre><p>Rescale the data set (in-place) according back to the original units</p><p><strong>Fields</strong></p><ul><li><code>data</code> - Data set to be scale</li><li><code>scalings</code> - Scalings to apply to <code>data</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/utils.jl#L83-L90">source</a></section></article><p>For example, the following code obtains the means and variances in the data:</p><pre><code class="language-julia hljs">scalings = get_scalings(data);
println(scalings.μx);
println(scalings.σ2x);
println(scalings.μy);
println(scalings.σ2y);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[0.4951311974073633, 0.4227013466569871]
[0.09152105546137086, 0.08417790437576789]
0.8120777535451472 + 0.0im
0.030862604324702423</code></pre><p>Next, we can scale our data:</p><pre><code class="language-julia hljs">scale_data!(data, scalings);

using Statistics
println(mean(data.x));
println(var(data.x));
println(mean(data.y));
println(var(data.y));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[2.220446049250313e-16, 5.551115123125783e-18]
[1.0000000000000002, 1.0]
-1.0824674490095276e-16 + 0.0im
1.0</code></pre><p>If needed, we can then undo the scaling,</p><pre><code class="language-julia hljs">rescale_data!(data, scalings)

println(mean(data.x));
println(var(data.x));
println(mean(data.y));
println(var(data.y));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[0.4951311974073633, 0.4227013466569871]
[0.09152105546137086, 0.08417790437576789]
0.8120777535451472 + 0.0im
0.030862604324702423</code></pre><p>Note that these are in agreement with what was contained in our <code>scalings</code> structure.</p><h2 id="Fourier-Feature-Models"><a class="docs-heading-anchor" href="#Fourier-Feature-Models">Fourier Feature Models</a><a id="Fourier-Feature-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Fourier-Feature-Models" title="Permalink"></a></h2><p>Fourier features approximates functions with <span>$K$</span> features according to</p><p class="math-container">\[f_{\rm true}(x) \approx f(x) = \sum_{k=1}^K \beta_k e^{i \omega_k \cdot x}\]</p><p>In the above expression, <span>$x,\omega_k\in \mathbb{R}^d$</span>, while <span>$\beta_k\in\mathbb{C}$</span>.  Consequently, our model is uniquely determined by the coefficients and the wavenumbers.  </p><p>A Fourier features model can be instantiated with a <code>FourierModel</code> structure:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.FourierModel" href="#ARFF.FourierModel"><code>ARFF.FourierModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FourierModel{TB&lt;:Complex,TW&lt;:AbstractArray{AbstractFloat}}</code></pre><p>Structure containing a scalar valued fourier model which will be learned</p><p><strong>Fields</strong></p><ul><li><code>β</code> - Array of complex coefficients</li><li><code>ω</code> - Array of wave vectors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/structs.jl#L2-L9">source</a></section></article><p>As an example,</p><pre><code class="language-julia hljs">Random.seed!(200); # for reproducibility

K = 10;
d = 2;

F = FourierModel([randn(ComplexF64) for _ in 1:K],
    [randn(d) for _ in 1:K]);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FourierModel{ComplexF64, Float64, Vector{Float64}}(ComplexF64[-0.5603272581116238 + 0.537977815860294im, -0.5706975858116924 - 0.0657348379263049im, 0.9069388509515408 + 0.9326057155997285im, 1.515643502824237 - 0.628782197570827im, 0.6562851968100064 - 0.2961858090925524im, -0.0826739515401274 - 0.022802052525077828im, 0.604928870663104 - 0.27642648514635815im, -1.0464139434115503 + 0.7296373349276786im, -0.48881518199590523 - 0.8415598542644231im, 1.7423067046684735 - 0.46776727576938804im], [[0.8446781051997678, 0.9249237650541624], [-0.5841871308675767, 0.3424865252782795], [-0.6974350383322714, 1.1297139822413678], [-1.243194987042106, -0.9922723588323762], [1.9537974625817172, -0.18686037485344426], [-1.146293771939666, 0.9226286258452874], [0.2055244369510107, 0.13819789976281208], [-0.7545830090756918, -0.8047536925085138], [-0.40084633859373503, 0.9736129994729481], [1.1241570456776535, 0.012007461271785093]])</code></pre><p>This defines <code>F</code> with random wavenumbers and amplitudes.  Strictly speaking, this is not required, but it is often helpful within the learning context that we will apply this method.  Function evaluation has been overloaded for a <code>FourierModel</code>, allowing us to evaluate it at points:</p><pre><code class="language-julia hljs">x_test = [0., 1.];
println(F(x_test));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7282986547022365 - 1.519135174016236im</code></pre><p>and it can perform a vectorized evaluation:</p><pre><code class="language-julia hljs">F.(data.x);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10-element Vector{ComplexF64}:
  2.572371797444079 - 0.32846457682090047im
  1.490829084355667 + 0.5531350300560932im
  2.454236019870696 - 0.6069350757566341im
 0.9512839985684965 + 1.4595234403213497im
   2.23938127404075 + 0.6011329243669247im
  1.402177185981037 + 0.9604237930565612im
  2.310382395689415 - 0.03620301242298618im
 2.1442245049767887 - 0.4386280559574237im
  1.057213513175309 + 1.242701539426801im
  1.577900993930898 + 0.8609533996844877im</code></pre><p>As is sometimes the case, we may scale our data, train in the scale coordinate, and wish to evaluate new poitns in the original, unscaled, coordinate system. We can accomplish that by passing a <a href="#ARFF.DataScalings"><code>DataScalings</code></a> argument in for evaluation:</p><pre><code class="language-julia hljs">F(x_test, scalings)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.7588121795654372 - 0.3087743228537007im</code></pre><h2 id="Training-Options"><a class="docs-heading-anchor" href="#Training-Options">Training Options</a><a id="Training-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Training-Options" title="Permalink"></a></h2><p>To train a <code>FourierModel</code>, the training options must first be specified by instantiating an <code>ARFFOptions</code> struct with the desired parameters.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ARFF.ARFFOptions" href="#ARFF.ARFFOptions"><code>ARFF.ARFFOptions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ARFFOptions{TI&lt;:Integer,TF&lt;:AbstractFloat,TB&lt;:Bool,TL,TS}</code></pre><p>Data structure containing the training options and parameters</p><p><strong>Fields</strong></p><ul><li><code>n_epochs</code> - Number of training epochs</li><li><code>n_ω_steps</code> - Number of internal RWM steps</li><li><code>δ</code> - RWM proposal step size</li><li><code>n_burn</code> - Number of epochs before the covariance adaptation begins</li><li><code>γ</code> - Metropolis-Hastings exponent</li><li><code>ω_max</code> - Maximum wave number norm cutoff</li><li><code>adapt_covariance</code> - Boolean for adaptivity</li><li><code>linear_solve!</code> - User specified solver for the normal equations</li><li><code>loss</code> - User specified loss function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gideonsimpson/ARFF.jl/blob/5264cd50c7801024510b6cb4e074ebb1b3aa2e3b/src/structs.jl#L119-L133">source</a></section></article><p>The above arguments are passed in as follows:</p><pre><code class="language-julia hljs">δ = 1.; # rwm step size
n_epochs = 10^3;
n_ω_steps = 10;
n_burn = 100;
γ = 1;
ω_max =Inf;
adapt_covariance = true;

β_solver! = (β, S, y, ω)-&gt; solve_normal!(β, S, y, λ);

linear_solve! = (β, S, y, ω)-&gt; reg_β_solver!(β, S, y, λ);

opts = ARFFOptions(n_epochs, n_ω_steps, δ, n_burn, γ, ω_max, adapt_covariance,
    linear_solve!, ARFF.mse_loss);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ARFFOptions{Int64, Float64, Bool, typeof(ARFF.mse_loss), Main.var&quot;#9#10&quot;}(1000, 10, 1.0, 100, 1, Inf, true, Main.var&quot;#9#10&quot;(), ARFF.mse_loss)</code></pre><p>The linear solver is typed as:</p><pre><code class="nohighlight hljs">function linear_solve!(β, S, y, ω)
    # in place solver code...
end</code></pre><p>which is to say, it can depend on the design matrix <span>$S$</span>, the response variables, <span>$y$</span>, and, potentially, the current set of wave numbers, <span>$ω$</span>.  See <a href="../aux/#linalg">Linear Algebra</a> for addititional details.</p><p>The <code>loss</code> function is to be typed as:</p><pre><code class="nohighlight hljs">function loss(F, x, y)
    # compute and return loss function...
end</code></pre><p>See <a href="../aux/#loss">Loss</a> for addititional details.</p><p>The <code>γ</code> parameter can be set using <a href="../aux/#ARFF.optimal_γ"><code>optimal_γ</code></a>, which, in a certain regime, is the optimal value for given dimension, <code>d</code> when <span>$x\in\mathbb{R}^d$</span>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../train/">Training »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 11 April 2024 17:39">Thursday 11 April 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
